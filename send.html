<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Send â€” Setfeed</title>
  <meta name="description" content="Send an end-to-end encrypted message to Setfeed." />
  <meta name="theme-color" content="#0F1114" />

  <link rel="icon" href="./favicon.ico" sizes="any">
  <link rel="icon" type="image/png" href="./favicon-32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="./favicon-16.png" sizes="16x16">
  <link rel="apple-touch-icon" href="./apple-touch-icon.png" sizes="180x180">

  <link rel="stylesheet" href="./styles.css" />

  <!-- =========================
       FIREBASE + APP CHECK
       ========================= -->

  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-check-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-functions-compat.js"></script>

  <script>
  const firebaseConfig = {
    apiKey: "AIzaSyCECKG-00tijJrt5qvRy3L27ZzE7bocNrU",
    authDomain: "setfeed-fcd7a.firebaseapp.com",
    projectId: "setfeed-fcd7a",
    storageBucket: "setfeed-fcd7a.firebasestorage.app",
    messagingSenderId: "553573263069",
    appId: "1:553573263069:web:e5c9884101ca38eaee1d34"
  };
    firebase.initializeApp(firebaseConfig);

    function startAppCheck(){
  try{
    firebase.appCheck().activate("6LfgvG0sAAAAANQjlRbdsWx6GMQw1kP2kuOPjeJI", true);
  }catch(e){
    // Keep calm + explicit: App Check init failure should be visible in console.
    console.error("App Check init failed:", e);
  }
}

// Ensure body exists before reCAPTCHA injects anything invisible.
if (document.readyState === "loading") {
  document.addEventListener("DOMContentLoaded", startAppCheck);
} else {
  startAppCheck();
}


    // Functions region
    const functions = firebase.app().functions("europe-west2");
  </script>

  <!-- =========================
       THEME + AUTH EARLY LOGIC
       ========================= -->

  <script>
    (function(){
      const THEME_KEY = "sf_theme_mode";
      const AUTH_KEY = "sf_signed_authed";
      const root = document.documentElement;

      function readThemeMode(){
        try { return localStorage.getItem(THEME_KEY) || "system"; }
        catch(e){ return "system"; }
      }

      function applyThemeAttr(){
        const stored = readThemeMode();
        if (stored === "light" || stored === "dark") root.setAttribute("data-theme", stored);
        else root.removeAttribute("data-theme");
      }

      applyThemeAttr();

      function isSystemDark(){
        return window.matchMedia && window.matchMedia("(prefers-color-scheme: dark)").matches;
      }

      function setThemeColor(){
        const meta = document.querySelector('meta[name="theme-color"]');
        if (!meta) return;

        const mode = readThemeMode();
        const effectiveDark = (mode === "dark") ? true : (mode === "light") ? false : isSystemDark();
        meta.setAttribute("content", effectiveDark ? "#0F1114" : "#FFFBFE");
      }

      setThemeColor();

      function applyAuthVisibility(){
        const authed = (localStorage.getItem(AUTH_KEY) === "true");
        document.querySelectorAll(".auth-only").forEach(el => {
          el.classList.toggle("hidden", !authed);
        });
      }

      applyAuthVisibility();
      document.addEventListener("DOMContentLoaded", applyAuthVisibility);

      window.addEventListener("storage", (e) => {
        if (!e) return;
        if (e.key === AUTH_KEY) applyAuthVisibility();
        if (e.key === THEME_KEY){
          applyThemeAttr();
          setThemeColor();
        }
      });
    })();
  </script>
</head>

<body class="page-bg">

  <!-- Everything below is unchanged from your original file -->
